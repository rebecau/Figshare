{% extends "base.html" %} {% block content %}

<!-- Masthead-->
<header class="masthead bg-dark text-white text-center">
<div id = "etnia">
</div>
    <table class="table text-light">
        <thead id="thead">

        </thead>
        <tbody id="tbody">
        </tbody>
    </table>
</header>

<script>
    
    var datos = JSON.parse( {{ tabla | tojson }});
    var etnia = window.localStorage.getItem('etnia')
    
    const filtrado = []
    
    let tabla_H = "<<tr> <th scope=\"col\">ID</th> <th scope=\"col\">Afro-American_percentage</th><th scope=\"col\">European_percentage</th> <th scope=\"col\">Indigenous_percentage</th> </tr>"
    document.getElementById("thead").innerHTML=tabla_H
    let tbody = " ";
    
    if (etnia === "A") {
        cadena="Afroecuatoriano";
        var arrays = getKey(datos['Etnia'],"Afroecuatoriano")
        
        for (let index = 0; index < arrays.length; index++) {
                    let ID = datos['ID'][`${arrays[index]}`]; 
                    let A = datos['Afro-American_percentage'][`${arrays[index]}`];
                    let E = datos['European_percentage'][`${arrays[index]}`];
                    let I = datos['Indigenous_percentage'][`${arrays[index]}`];
                    // filtrado.push({'ID':ID,'A':A,'E':E,'I': I})
                    tbody+= '<tr>';
                    tbody+= '<td>' + ID + '</td>';
                    tbody+= '<td>' + A + '</td>';
                    tbody+= '<td>' + E + '</td>';
                    tbody+= '<td>' + I + '</td>';
                    tbody+= '</tr>';
        }
        document.getElementById("tbody").innerHTML = tbody

    }else if (etnia === "E") {
        cadena = "EuroDesendiente"
        var arrays = getKey(datos['Etnia'],"EuroDesendiente")
        for (let index = 0; index < arrays.length; index++) {
            const ID = datos['ID'][`${arrays[index]}`];
            const A = datos['Afro-American_percentage'][`${arrays[index]}`];
            const E = datos['European_percentage'][`${arrays[index]}`];
            const I = datos['Indigenous_percentage'][`${arrays[index]}`];
            tbody+= '<tr>';
            tbody+= '<td>' + ID + '</td>';
            tbody+= '<td>' + A + '</td>';
            tbody+= '<td>' + E + '</td>';
            tbody+= '<td>' + I + '</td>';
            tbody+= '</tr>';
        // console.log(ID+" "+A+" "+E+" "+I);
        }
        document.getElementById("tbody").innerHTML = tbody

    } else if (etnia === 'I') {
        cadena = "Indigena"
        var arrays = getKey(datos['Etnia'],"Indigena")
        for (let index = 0; index < arrays.length; index++) {
            const ID = datos['ID'][`${arrays[index]}`];
            const A = datos['Afro-American_percentage'][`${arrays[index]}`];
            const E = datos['European_percentage'][`${arrays[index]}`];
            const I = datos['Indigenous_percentage'][`${arrays[index]}`];
            tbody+= '<tr>';
            tbody+= '<td>' + ID + '</td>';
            tbody+= '<td>' + A + '</td>';
            tbody+= '<td>' + E + '</td>';
            tbody+= '<td>' + I + '</td>';
            tbody+= '</tr>';
        // console.log(ID+" "+A+" "+E+" "+I);
        }
        document.getElementById("tbody").innerHTML = tbody
        
    } else if (etnia === "M") {
        cadena = "Meztizo"
        var arrays = getKey(datos['Etnia'],"Meztizo")
        for (let index = 0; index < arrays.length; index++) {
            const ID = datos['ID'][`${arrays[index]}`];
            const A = datos['Afro-American_percentage'][`${arrays[index]}`];
            const E = datos['European_percentage'][`${arrays[index]}`];
            const I = datos['Indigenous_percentage'][`${arrays[index]}`];
            tbody+= '<tr>';
            tbody+= '<td>' + ID + '</td>';
            tbody+= '<td>' + A + '</td>';
            tbody+= '<td>' + E + '</td>';
            tbody+= '<td>' + I + '</td>';
            tbody+= '</tr>';
        // console.log(ID+" "+A+" "+E+" "+I);
        }
        document.getElementById("tbody").innerHTML = tbody
    }

    document.getElementById('etnia').innerHTML = "<h5>"+cadena+"</h5>"

  
    function getKey(veg,cadena){
        const arr = [];
        obj = Object.keys(veg);
        for (var x in obj){
            if(veg[obj[x]] === cadena){
                arr.push(x);
            }
        }
        return arr;
    }

    let ObtenerCadena = (arreglo) =>{
        let k = '';
        for(i = 0;i < array.length; i++){
            k+= '<tr>';
            k+= '<td>' + array[i].ID + '</td>';
            k+= '<td>' + array[i].A + '</td>';
            k+= '<td>' + array[i].E + '</td>';
            k+= '<td>' + array[i].I + '</td>';
            k+= '</tr>';
        }  
        console.log(k)
        return 0;
    }



</script>
{% endblock %}